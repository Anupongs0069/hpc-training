# **‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏â‡∏ö‡∏±‡∏ö‡∏ó‡∏µ‡πà 4 ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Agent-Based Simulation ‡∏ö‡∏ô LANTA Supercomputer**
### **‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠: ‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏£‡πà‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ç‡πà‡∏≤‡∏ß‡∏•‡∏∑‡∏≠‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ HPC**
---

## **1. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå**
‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå:
```bash
mkdir rumor_simulation
cd rumor_simulation
```
‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πà‡∏≤‡∏á‡πÜ:

üìÑ **`student.py`** ‚Üí ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏•‡∏≤‡∏™‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô (Agent)  
üìÑ **`model.py`** ‚Üí ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏• (Model)  
üìÑ **`run_simulation.py`** ‚Üí ‡∏£‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå  
üìÑ **`submit_simulation.sh`** ‚Üí ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡πà LANTA  

---

## **2. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡∏î‡∏π‡∏•**
### **2.1 ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡∏î‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ô LANTA**
```bash
module load Mamba/23.11.0-0
conda activate /project/cb900902-hpct01/envs/hpc-mesa
```
> **‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:** netcdf-py39 ‡∏°‡∏µ Python ‡πÅ‡∏•‡∏∞‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°

---

## **3. ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î**
### **üìÑ `student.py` ‚Äì ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô**
```python
from mesa import Agent

# ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
IGNORANT = 0  # ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏Ç‡πà‡∏≤‡∏ß
SPREADER = 1  # ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏û‡∏£‡πà‡∏Ç‡πà‡∏≤‡∏ß
STIFLER = 2   # ‡πÄ‡∏ö‡∏∑‡πà‡∏≠‡∏Ç‡πà‡∏≤‡∏ß

class Student(Agent):
    def __init__(self, unique_id, model, status):
        super().__init__(unique_id, model)
        self.status = status

    def step(self):
        """‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏û‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"""
        neighbors = self.model.grid.get_neighbors(self.pos, moore=True, include_center=False)
        for neighbor in neighbors:
            if self.status == SPREADER and neighbor.status == IGNORANT:
                if self.random.random() < 0.4:  # 40% ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏∞‡∏£‡∏±‡∏ö‡∏Ç‡πà‡∏≤‡∏ß
                    neighbor.status = SPREADER
            elif self.status == SPREADER and neighbor.status in [SPREADER, STIFLER]:
                if self.random.random() < 0.2:  # 20% ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ó‡∏µ‡πà Spreader ‡∏à‡∏∞‡πÄ‡∏ö‡∏∑‡πà‡∏≠
                    self.status = STIFLER
```

---

### **üìÑ `model.py` ‚Äì ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô**
```python
from mesa import Model
from mesa.time import RandomActivation
from mesa.space import MultiGrid
import numpy as np
from student import Student, IGNORANT, SPREADER, STIFLER

class SchoolModel(Model):
    def __init__(self, width, height, num_students):
        super().__init__()
        self.grid = MultiGrid(width, height, True)
        self.schedule = RandomActivation(self)

        # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 10,000 ‡∏Ñ‡∏ô
        for i in range(num_students):
            status = IGNORANT if np.random.rand() > 0.05 else SPREADER  # ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 5% ‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡∏Ç‡πà‡∏≤‡∏ß
            student = Student(i, self, status)
            self.schedule.add(student)
            x, y = self.random.randrange(width), self.random.randrange(height)
            self.grid.place_agent(student, (x, y))

    def step(self):
        """‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏£‡∏≠‡∏ö"""
        self.schedule.step()
```

---

### **üìÑ `run_simulation.py` ‚Äì ‡∏£‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**
```python
import numpy as np
import csv
from model import SchoolModel, IGNORANT, SPREADER, STIFLER

def run_simulation(steps=100, width=100, height=100, num_students=10000):
    model = SchoolModel(width, height, num_students)
    
    ignorant_counts, spreader_counts, stifler_counts = [], [], []

    for _ in range(steps):
        model.step()
        statuses = [agent.status for agent in model.schedule.agents]
        ignorant_counts.append(statuses.count(IGNORANT))
        spreader_counts.append(statuses.count(SPREADER))
        stifler_counts.append(statuses.count(STIFLER))

    # ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå CSV
    with open("results.csv", "w", newline="") as f:
        writer = csv.writer(f)
        writer.writerow(["Step", "Ignorant", "Spreader", "Stifler"])
        for i in range(steps):
            writer.writerow([i, ignorant_counts[i], spreader_counts[i], stifler_counts[i]])

# ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô
run_simulation()
```

---

### **üìÑ `submit_simulation.sh` ‚Äì ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡πà LANTA**
```bash
#!/bin/bash
#SBATCH -p compute  # ‡πÉ‡∏ä‡πâ‡πÇ‡∏´‡∏ô‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
#SBATCH -N 1        # ‡πÉ‡∏ä‡πâ 1 ‡πÇ‡∏´‡∏ô‡∏î
#SBATCH --ntasks=32  # ‡πÉ‡∏ä‡πâ 32 ‡∏Ñ‡∏≠‡∏£‡πå
#SBATCH -t 01:00:00  # ‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
#SBATCH -J rumor_simulation  # ‡∏ä‡∏∑‡πà‡∏≠ Job
#SBATCH -A cb900902  # ‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô

module load Mamba/23.11.0-0
conda activate /lustrefs/disk/project/cb900902/envs/hpc-mesa

python3 run_simulation.py  # ‡∏£‡∏±‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ
```

---

## **4. ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏ö‡∏ô LANTA Supercomputer**
### **4.1 ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡πà LANTA**
```bash
sbatch submit_simulation.sh
```

### **4.2 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô**
```bash
myqueue
```

### **4.3 ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå**
```bash
scp hpcuser@transfer.lanta.nstda.or.th:/home/hpcuser/results.csv .
```

---

## **5. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ö‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß**
### **üìÑ `analyze_results.py` ‚Äì ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•**
```python
import numpy as np
import matplotlib.pyplot as plt
import csv

# Read CSV file and skip the header
data = np.loadtxt("results.csv", delimiter=",", skiprows=1)

# Unpack data correctly
steps = data[:, 0]  # Step column
ignorant_counts = data[:, 1]  # Ignorant column
spreader_counts = data[:, 2]  # Spreader column
stifler_counts = data[:, 3]  # Stifler column

# Plot the results
plt.figure(figsize=(10, 5))
plt.plot(steps, ignorant_counts, label="Ignorant (‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏Ç‡πà‡∏≤‡∏ß)", color="blue")
plt.plot(steps, spreader_counts, label="Spreader (‡πÅ‡∏û‡∏£‡πà‡∏Ç‡πà‡∏≤‡∏ß)", color="red")
plt.plot(steps, stifler_counts, label="Stifler (‡πÄ‡∏ö‡∏∑‡πà‡∏≠‡∏Ç‡πà‡∏≤‡∏ß)", color="green")
plt.xlabel("‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á (Steps)")
plt.ylabel("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô (Number of People)")
plt.legend()
plt.title("‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏£‡πà‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ç‡πà‡∏≤‡∏ß‡∏•‡∏∑‡∏≠‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (Rumor Spread Simulation)")
plt.grid()
plt.show()
```

### **5.1 ‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå**
```bash
python3 analyze_results.py
```

---

## **6. ‡∏™‡∏£‡∏∏‡∏õ**
### ‚úÖ ‡∏ó‡∏≥‡πÑ‡∏° HPC ‡∏ö‡∏ô LANTA ‡∏ñ‡∏∂‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç?
üöÄ **‡∏£‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤ PC ‡∏ñ‡∏∂‡∏á 100 ‡πÄ‡∏ó‡πà‡∏≤**  
üìà **‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 10,000 ‡∏Ñ‡∏ô ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÑ‡∏°‡πà‡∏Å‡∏µ‡πà‡∏ô‡∏≤‡∏ó‡∏µ**  
üî¨ **‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏î‡πâ**  

üì¢ **‡∏•‡∏≠‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡πÉ‡∏´‡πâ‡∏°‡∏µ "Influencer" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏Ç‡πà‡∏≤‡∏ß‡∏õ‡∏•‡∏≠‡∏°" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ó‡πá‡∏à!**

---

## üéØ **LANTA Supercomputer ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ! üöÄ**
